<turbo-frame id='main'> 
  <div class="flex justify-between items-center mb-6">
    <h1 class="text-2xl font-bold"><%= t("recipes.index.title") %></h1>
    <%= link_to t("recipes.index.new_recipe"), new_recipe_path, class: "bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-md" %>
  </div>

  <%= form_with url: recipes_path, method: :get, local: true, class: "mb-6" do |f| %>
    <div class="relative">
      <%= f.text_field :search, 
            placeholder: t("recipes.index.search_placeholder"),
            value: params[:search], autocomplete: "off",
            class: "w-full rounded-lg border-gray-300 pl-10 pr-4 py-2 border focus:ring-blue-500 focus:border-blue-500" %>
      <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
        <svg class="h-5 w-5 text-gray-400" fill="currentColor" viewBox="0 0 20 20">
          <path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" clip-rule="evenodd"></path>
        </svg>
      </div>
    </div>
  <% end %>

  <% if recipes.blank? %>
    <div class="bg-white rounded-lg shadow p-6 text-center">
      <% if params[:search].present? %>
        <p class="text-gray-500 mb-4"><%= t("recipes.index.no_match", query: params[:search]) %></p>
      <% else %>
        <p class="text-gray-500 mb-4"><%= t("recipes.index.no_recipes") %></p>
      <% end %>
      <%= link_to t("recipes.index.create_first"), new_recipe_path, class: "bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-md inline-block" %>
    </div>
  <% else %>
    <div class="space-y-6">
      <% recipes.each do |recipe| %>
        <%= link_to edit_recipe_path(recipe), class: "block" do %>
          <div id="recipe_<%= recipe.id %>" class="bg-white rounded-lg shadow p-6 hover:bg-gray-50 transition-colors duration-200">
            <div class="flex justify-between items-start">
              <div>
                <h2 class="text-xl font-semibold"><%= recipe.name %></h2>
                <p class="text-sm text-gray-500 mt-1"><%= t("recipes.index.recipe_id", id: recipe.uid) %></p>
                <p class="text-sm font-medium text-gray-500 mt-1">
                  <%= t("recipes.index.price") %>: <%= number_to_currency(recipe.price) %>
                </p>
              </div>
              <div class="text-blue-500 hover:text-blue-700">
                <%= t("recipes.index.edit") %>
              </div>
            </div>

            <div class="mt-4">
              <h3 class="font-bold text-gray-700 mb-2"><%= t("recipes.index.ingredients") %></h3>
              <ul class="space-y-3">
                <% recipe.recipe_items.each do |item| %>
                  <li class="flex items-center gap-4">
                    <span class="w-1/2"><%= item.product.name %></span>
                    <span class="w-1/4"><%= item.quantity %></span>
                    <span class="w-1/4"><%= item.unit.humanize %></span>
                  </li>
                <% end %>
              </ul>

              <div class="mt-4 text-sm text-gray-500">
                <%= t("recipes.index.updated_ago", time: time_ago_in_words(recipe.updated_at)) %>
              </div>
            </div>
          </div>
        <% end %>
      <% end %>
    </div>
  <% end %>
</turbo-frame>
