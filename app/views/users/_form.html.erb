<%= form_with(model: Current.user, local: true, data: { turbo: false }, method: :put, class: "space-y-2 max-w-3xl mx-auto mt-10") do |form| %>
  <!-- User Information Section -->
  <div class="bg-white shadow-sm rounded-xl p-6 border border-gray-200">
    <h2 class="text-lg font-semibold mb-6 text-gray-800"><%= t("settings.user_info") %></h2>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
      <!-- Name -->
      <div>
        <%= form.label :name, t("settings.full_name"), class: "block text-sm font-medium text-gray-700 mb-1" %>
        <%= form.text_field :name, value: Current.user.name, class: "w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500" %>
      </div>

      <!-- Phone -->
      <div>
        <%= form.label :phone, t("settings.phone_number"), class: "block text-sm font-medium text-gray-700 mb-1" %>
        <%= form.text_field :phone, value: Current.user.phone,
            class: "w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500",
            pattern: "[0-9]*",
            title: t("settings.phone_number_hint") %>
      </div>

      <!-- Email -->
      <div class="md:col-span-2">
        <%= form.label :email_address, t("settings.email"), class: "block text-sm font-medium text-gray-700 mb-1" %>
        <%= form.email_field :email_address, value: Current.user.email_address, class: "w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500" %>
      </div>

      <!-- Language -->
      <div class="space-y-2">
        <%= form.label :locale, t("settings.language"), class: "block text-sm font-medium text-gray-700" %>
        <%= form.select :locale, [[t("languages.english"), 'en'], [t("languages.spanish"), 'es']],
              {}, class: "block w-full pl-3 pr-10 py-3 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm" %>
      </div>
    </div>
  </div>

  <% if ['plus', 'premium', 'starter', 'trial'].include?(Current.account.subscription.plan) %>
    <!-- Notification Settings Section -->
    <div class="bg-white shadow-sm rounded-xl p-6 border border-gray-200">
      <h2 class="text-lg font-semibold mb-6 text-gray-800"><%= t("settings.notifications") %></h2>

      <div class="space-y-6">
        <!-- Email Notification -->
        <div class="flex items-center justify-between">
          <div class="flex items-center space-x-2">
            <%= form.check_box :email_notification, class: "h-5 w-5 text-blue-600 rounded border-gray-300 focus:ring-blue-500" %>
            <%= form.label :email_notification, t("settings.receive_email"), class: "ml-2 text-sm text-gray-700" %>
          </div>
        </div>
  <% end %>

  <% if ['plus', 'premium'].include?(Current.account.subscription.plan) %>
        <!-- Text Notification -->
        <div class="flex items-center justify-between">
          <div class="flex items-center space-x-2">
            <%= form.check_box :text_notification, class: "h-5 w-5 text-blue-600 rounded border-gray-300 focus:ring-blue-500" %>
            <%= form.label :text_notification, t("settings.receive_text"), class: "ml-2 text-sm text-gray-700" %>
          </div>
        </div>
      </div>
    </div>
  <% end %>

  <br>

  <div class="flex">
    <%= form.submit t("settings.update_button"), class: "bg-blue bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition", style: 'padding-left: 2.2rem; padding-right: 2.2rem;' %>
  </div>
<% end %>

<br>

<div id='notifications-section'>
  <% if ['plus', 'premium', 'starter', 'free', 'trial'].include?(Current.account.subscription.plan) %>
      <!-- Test Email -->
      <%= form_with url: send_test_email_user_path(Current.user), method: :post, data: { turbo_frame: "notifications" }, class: "inline-block", local: false do %>
        <%= submit_tag t("settings.test_email"), class: "bg-blue bg-blue-600 text-white px-4 py-1 rounded-md text-sm hover:bg-blue-700 transition" %>
      <% end %>
  <% end %>

  <% if ['plus', 'premium'].include?(Current.account.subscription.plan) %>
      <!-- Test Text -->
      <%= form_with url: send_test_text_user_path(Current.user), method: :post, data: { turbo_frame: "notifications" }, class: "inline-block", local: false do %>
        <%= submit_tag t("settings.test_text"), class: "bg-blue bg-blue-600 text-white px-4 py-1 rounded-md text-sm hover:bg-blue-700 transition" %>
      <% end %>
  <% end %>
</div>

<br>