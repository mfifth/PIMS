<turbo-frame id='main'>
  <h1 class="text-3xl font-semibold text-gray-700 mb-4">Product Details</h1>

  <div class="bg-white shadow-md rounded-lg p-6 space-y-4">
    <!-- Product Name -->
    <div>
      <h2 class="text-xl font-medium text-gray-800"><%= @product.name %></h2>
      <p class="text-sm text-gray-500"><%= @product.sku %></p>
    </div>

    <!-- Category & Description -->
    <div>
      <span class="text-gray-700 font-semibold">Category:</span>
      <span class="text-gray-600"><%= @product.category&.name&.titleize || 'N/A' %></span>
    </div>
    <div>
      <span class="text-gray-700 font-semibold">Description:</span>
      <p class="text-gray-600"><%= @product.description.presence || 'No description available' %></p>
    </div>

    <!-- Price -->
    <div>
      <span class="text-gray-700 font-semibold">Price:</span>
      <span class="text-green-600 font-medium">$<%= @product.price %></span>
    </div>

    <!-- Perishable Status -->
    <div>
      <span class="text-gray-700 font-semibold">Perishable:</span>
      <span class="<%= @product.perishable? ? 'text-red-600' : 'text-gray-600' %>">
        <%= @product.perishable? ? 'Yes' : 'No' %>
      </span>
    </div>

    <!-- Supplier -->
    <div>
      <span class="text-gray-700 font-semibold">Supplier:</span>
      <span class="text-gray-600"><%= @product.supplier&.name || 'Not assigned' %></span>
    </div>

    <!-- Batch Information -->
    <% if @product.perishable? %>
      <div class="bg-gray-100 p-4 rounded-lg">
        <h3 class="text-lg font-medium text-gray-700">Batch Information</h3>
        <% if @product.batch.present? %>
          <div>
            <span class="text-gray-700 font-semibold">Batch Number:</span>
            <span class="text-gray-600"><%= @product.batch.batch_number.presence || 'N/A' %></span>
          </div>
          <div>
            <span class="text-gray-700 font-semibold">Manufactured Date:</span>
            <span class="text-gray-600"><%= @product.batch.manufactured_date&.strftime('%B %d, %Y') || 'N/A' %></span>
          </div>
          <div>
            <span class="text-gray-700 font-semibold">Expiration Date:</span>
            <span class="text-gray-600"><%= @product.batch.expiration_date&.strftime('%B %d, %Y') || 'N/A' %></span>
          </div>
        <% else %>
          <p class="text-gray-600">No batch information available.</p>
        <% end %>
      </div>
    <% end %>

    <!-- Inventory Information -->
    <div class="bg-gray-100 p-4 rounded-lg">
      <h3 class="text-lg font-medium text-gray-700">Inventory Information</h3>
      
      <% if @locations.any? %>
        <% @locations.each do |location| %>
          <div class="border-b border-gray-300 py-2">
            <span class="text-gray-700 font-semibold">Location:</span>
            <span class="text-gray-600"><%= location.name %></span>
            
            <% inventory_item = location.inventory_items.find_by(product_id: @product.id) %>
            <% if inventory_item %>
              <div>
                <span class="text-gray-700 font-semibold">Quantity:</span>
                <span class="text-gray-600"><%= inventory_item.quantity %></span>
              </div>
              <div>
                <span class="text-gray-700 font-semibold">Low Threshold:</span>
                <span class="text-gray-600"><%= inventory_item.low_threshold || 'N/A' %></span>
              </div>
            <% else %>
              <p class="text-gray-600">No inventory data for this location.</p>
            <% end %>
          </div>
        <% end %>
      <% else %>
        <p class="text-gray-600">No inventory locations found for this product.</p>
      <% end %>
    </div>

    <!-- Actions -->
    <div class="flex space-x-4 mt-4">
      <%= link_to "Edit Product", edit_product_path(@product), data: { turbo: false }, class: "px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700" %>
      <%= link_to "Back to Products", products_path, data: { turbo: false }, class: "px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700" %>
      <%= link_to "Delete", product_path(@product), data: { turbo_method: :delete, turbo_frame: 'main', turbo_confirm: "Are you sure you want to delete this product?"}, class: "px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700" %>
    </div>
  </div>
</turbo-frame>