<turbo-frame id='main'>
  <h1 class="text-3xl font-semibold text-gray-700 mb-4"><%= t('products.details.title') %></h1>

  <div class="bg-white shadow-md rounded-lg p-6 space-y-4">
    <!-- Product Name -->
    <div>
      <h2 class="text-xl font-medium text-gray-800"><%= @product.name %></h2>
      <p class="text-sm text-gray-500"><%= @product.sku %></p>
    </div>

    <!-- Category & Description -->
    <div>
      <span class="text-gray-700 font-semibold"><%= t('products.details.category') %>:</span>
      <span class="text-gray-600"><%= @product.category&.name&.titleize || t('products.details.na') %></span>
    </div>
    <div>
      <span class="text-gray-700 font-semibold"><%= t('products.details.unit_type') %>:</span>
      <span class="text-gray-600"><%= @product.unit_type %></span>
    </div>
    <div>
      <span class="text-gray-700 font-semibold"><%= t('products.details.description') %>:</span>
      <p class="text-gray-600"><%= @product.description.presence || t('products.details.no_description') %></p>
    </div>

    <!-- Price -->
    <div>
      <span class="text-gray-700 font-semibold"><%= t('products.details.price') %>:</span>
      <span class="text-green-600 font-medium">$<%= @product.price %></span>
    </div>

    <!-- Perishable Status -->
    <div>
      <span class="text-gray-700 font-semibold"><%= t('products.details.perishable') %>:</span>
      <span class="<%= @product.perishable? ? 'text-red-600' : 'text-gray-600' %>">
        <%= @product.perishable? ? t('products.details.yes') : t('products.details.no') %>
      </span>
    </div>

    <!-- Batch Information -->
    <% if @product.perishable? %>
      <div class="bg-gray-100 p-4 rounded-lg">
        <h3 class="text-lg font-medium text-gray-700"><%= t('products.details.batch_info.title') %></h3>
        <% if @product.batch.present? %>
          <div>
            <span class="text-gray-700 font-semibold"><%= t('products.details.batch_info.number') %>:</span>
            <span class="text-gray-600"><%= @product.batch.batch_number.presence || t('products.details.na') %></span>
          </div>
          <div>
            <span class="text-gray-700 font-semibold"><%= t('products.details.batch_info.manufactured') %>:</span>
            <span class="text-gray-600"><%= @product.batch.manufactured_date&.strftime('%B %d, %Y') || t('products.details.na') %></span>
          </div>
          <div>
            <span class="text-gray-700 font-semibold"><%= t('products.details.batch_info.expiration') %>:</span>
            <span class="text-gray-600"><%= @product.batch.expiration_date&.strftime('%B %d, %Y') || t('products.details.na') %></span>
          </div>
        <% else %>
          <p class="text-gray-600"><%= t('products.details.batch_info.none') %></p>
        <% end %>
      </div>
    <% end %>

    <!-- Inventory Information -->
    <div class="bg-gray-100 p-4 rounded-lg">
      <h3 class="text-lg font-medium text-gray-700"><%= t('products.details.inventory_info.title') %></h3>

      <% if @locations.any? %>
        <% @locations.each do |location| %>
          <div class="border-b border-gray-300 py-2">
            <span class="text-gray-700 font-semibold"><%= t('products.details.inventory_info.location') %>:</span>
            <span class="text-gray-600"><%= location.name %></span>

            <% inventory_item = location.inventory_items.find_by(product_id: @product.id) %>
            <% if inventory_item %>
              <div>
                <span class="text-gray-700 font-semibold"><%= t('products.details.inventory_info.quantity') %>:</span>
                <span class="text-gray-600"><%= inventory_item.quantity %></span>
              </div>
              <div>
                <span class="text-gray-700 font-semibold"><%= t('products.details.inventory_info.low_stock') %>:</span>
                <span class="text-gray-600"><%= inventory_item.low_threshold || t('products.details.na') %></span>
              </div>
            <% else %>
              <p class="text-gray-600"><%= t('products.details.inventory_info.none') %></p>
            <% end %>
          </div>
        <% end %>
      <% else %>
        <p class="text-gray-600"><%= t('products.details.inventory_info.no_locations') %></p>
      <% end %>
    </div>

    <!-- Actions -->
    <div class="flex space-x-4 mt-4">
      <%= link_to t('products.details.actions.edit'), edit_product_path(@product), data: { turbo: false }, class: "px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700" %>
      <%= link_to t('products.details.actions.back'), products_path, data: { turbo: false }, class: "px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700" %>
      <%= link_to t('products.details.actions.delete'), product_path(@product), data: { turbo_method: :delete, turbo_frame: 'main', turbo_confirm: t('products.details.actions.confirm_delete') }, class: "px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700" %>
    </div>
  </div>
</turbo-frame>
